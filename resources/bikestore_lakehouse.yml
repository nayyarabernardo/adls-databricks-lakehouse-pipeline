resources:
  jobs:
    bikestore_lakehouse:
      name: bikestore_lakehouse
      email_notifications:
        on_start:
          - {STORAGE_ACCOUNT_EMAIL}
        on_failure:
          - {STORAGE_ACCOUNT_EMAIL}
      schedule:
        quartz_cron_expression: 17 0 14 * * ?
        timezone_id: America/Maceio
        pause_status: UNPAUSED
      tasks:
        - task_key: bronze_table_brands
          notebook_task:
            notebook_path: /Workspace/Users/{STORAGE_ACCOUNT_NAME}/adls-databricks-lakehouse-pipeline/notebooks/01_bronze/01_bronze_pipeline
            base_parameters:
              table_name: brands
            source: WORKSPACE
          existing_cluster_id: 0103-165844-69qqs2yo
        - task_key: bronze_table_categories
          notebook_task:
            notebook_path: /Workspace/Users/{STORAGE_ACCOUNT_NAME}/adls-databricks-lakehouse-pipeline/notebooks/01_bronze/01_bronze_pipeline
            base_parameters:
              table_name: categories
            source: WORKSPACE
          existing_cluster_id: 0103-165844-69qqs2yo
        - task_key: bronze_table_customers
          notebook_task:
            notebook_path: /Workspace/Users/{STORAGE_ACCOUNT_NAME}/adls-databricks-lakehouse-pipeline/notebooks/01_bronze/01_bronze_pipeline
            base_parameters:
              table_name: customers
            source: WORKSPACE
          existing_cluster_id: 0103-165844-69qqs2yo
        - task_key: bronze_table_order_items
          notebook_task:
            notebook_path: /Workspace/Users/{STORAGE_ACCOUNT_NAME}/adls-databricks-lakehouse-pipeline/notebooks/01_bronze/01_bronze_pipeline
            base_parameters:
              table_name: order_items
            source: WORKSPACE
          existing_cluster_id: 0103-165844-69qqs2yo
        - task_key: bronze_table_orders
          notebook_task:
            notebook_path: /Workspace/Users/{STORAGE_ACCOUNT_NAME}/adls-databricks-lakehouse-pipeline/notebooks/01_bronze/01_bronze_pipeline
            base_parameters:
              table_name: orders
            source: WORKSPACE
          existing_cluster_id: 0103-165844-69qqs2yo
        - task_key: bronze_table_products
          notebook_task:
            notebook_path: /Workspace/Users/{STORAGE_ACCOUNT_NAME}/adls-databricks-lakehouse-pipeline/notebooks/01_bronze/01_bronze_pipeline
            base_parameters:
              table_name: products
            source: WORKSPACE
          existing_cluster_id: 0103-165844-69qqs2yo
        - task_key: bronze_table_staffs
          notebook_task:
            notebook_path: /Workspace/Users/{STORAGE_ACCOUNT_NAME}/adls-databricks-lakehouse-pipeline/notebooks/01_bronze/01_bronze_pipeline
            base_parameters:
              table_name: staffs
            source: WORKSPACE
          existing_cluster_id: 0103-165844-69qqs2yo
        - task_key: bronze_table_stocks
          notebook_task:
            notebook_path: /Workspace/Users/{STORAGE_ACCOUNT_NAME}/adls-databricks-lakehouse-pipeline/notebooks/01_bronze/01_bronze_pipeline
            base_parameters:
              table_name: stocks
            source: WORKSPACE
          existing_cluster_id: 0103-165844-69qqs2yo
        - task_key: bronze_table_stores
          notebook_task:
            notebook_path: /Workspace/Users/{STORAGE_ACCOUNT_NAME}/adls-databricks-lakehouse-pipeline/notebooks/01_bronze/01_bronze_pipeline
            base_parameters:
              table_name: stores
            source: WORKSPACE
          existing_cluster_id: 0103-165844-69qqs2yo
        - task_key: validation_bronze
          depends_on:
            - task_key: bronze_table_stocks
            - task_key: bronze_table_staffs
            - task_key: bronze_table_products
            - task_key: bronze_table_customers
            - task_key: bronze_table_stores
            - task_key: bronze_table_orders
            - task_key: bronze_table_categories
            - task_key: bronze_table_order_items
            - task_key: bronze_table_brands
          notebook_task:
            notebook_path: /Workspace/Users/{STORAGE_ACCOUNT_NAME}/adls-databricks-lakehouse-pipeline/notebooks/01_bronze/02_validation_bronze
            source: WORKSPACE
          existing_cluster_id: 0103-165844-69qqs2yo
        - task_key: silver_table_customers
          depends_on:
            - task_key: validation_bronze
          notebook_task:
            notebook_path: /Workspace/Users/{STORAGE_ACCOUNT_NAME}/adls-databricks-lakehouse-pipeline/notebooks/02_silver/01_silver_pipeline
            base_parameters:
              table_name: customers
            source: WORKSPACE
          existing_cluster_id: 0103-165844-69qqs2yo
        - task_key: silver_table_orders
          depends_on:
            - task_key: validation_bronze
          notebook_task:
            notebook_path: /Workspace/Users/{STORAGE_ACCOUNT_NAME}/adls-databricks-lakehouse-pipeline/notebooks/02_silver/01_silver_pipeline
            base_parameters:
              table_name: orders
            source: WORKSPACE
          existing_cluster_id: 0103-165844-69qqs2yo
        - task_key: silver_table_products
          depends_on:
            - task_key: validation_bronze
          notebook_task:
            notebook_path: /Workspace/Users/{STORAGE_ACCOUNT_NAME}/adls-databricks-lakehouse-pipeline/notebooks/02_silver/01_silver_pipeline
            base_parameters:
              table_name: products
            source: WORKSPACE
          existing_cluster_id: 0103-165844-69qqs2yo
        - task_key: validation_silver
          depends_on:
            - task_key: silver_table_orders
            - task_key: silver_table_products
            - task_key: silver_table_customers
          notebook_task:
            notebook_path: /Workspace/Users/{STORAGE_ACCOUNT_NAME}/adls-databricks-lakehouse-pipeline/notebooks/02_silver/02_validation_silver
            source: WORKSPACE
          existing_cluster_id: 0103-165844-69qqs2yo
        - task_key: gold_table_orders_pending
          depends_on:
            - task_key: validation_silver
          notebook_task:
            notebook_path: /Workspace/Users/{STORAGE_ACCOUNT_NAME}/adls-databricks-lakehouse-pipeline/notebooks/03_gold/01_gold_pipeline
            base_parameters:
              table_name: orders_pending
            source: WORKSPACE
          existing_cluster_id: 0103-165844-69qqs2yo
        - task_key: gold_table_sales_ny
          depends_on:
            - task_key: validation_silver
          notebook_task:
            notebook_path: /Workspace/Users/{STORAGE_ACCOUNT_NAME}/adls-databricks-lakehouse-pipeline/notebooks/03_gold/01_gold_pipeline
            base_parameters:
              table_name: sales_ny
            source: WORKSPACE
          existing_cluster_id: 0103-165844-69qqs2yo
      queue:
        enabled: true

